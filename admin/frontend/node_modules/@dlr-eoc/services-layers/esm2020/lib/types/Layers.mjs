/** can be raster and vector */
export const TmsLayertype = 'tms';
export const WmsLayertype = 'wms';
export const WmtsLayertype = 'wmts';
export const XyzLayertype = 'xyz';
export const GeojsonLayertype = 'geojson';
export const KmlLayertype = 'kml';
export const WfsLayertype = 'wfs';
/** can be raster and vector */
export const CustomLayertype = 'custom';
/** can have multiple layers raster, vector... */
export const StackedLayertype = 'stacked';
export const Filtertypes = {
    Baselayers: 'Baselayers',
    Overlays: 'Overlays',
    Layers: 'Layers'
};
/**
 * @deprecated The method should not be used because it can be false positive
 *
 * CustomLayertype and TmsLayertype can be raster and vector.
 * You have to double check by yourself later!
 */
export function isVectorLayertype(inpt) {
    return [GeojsonLayertype, WfsLayertype, CustomLayertype, KmlLayertype, TmsLayertype].includes(inpt);
}
/**
 * @deprecated The method should not be used because it can be false positive
 *
 * CustomLayertype and TmsLayertype can be raster and vector.
 * You have to double check by yourself later!
 */
export function isRasterLayertype(inpt) {
    return [WmsLayertype, WmtsLayertype, XyzLayertype, CustomLayertype, TmsLayertype].includes(inpt);
}
export function isLayertype(type) {
    return [TmsLayertype, WmsLayertype, WmtsLayertype, XyzLayertype, GeojsonLayertype, KmlLayertype, WfsLayertype, CustomLayertype].includes(type);
}
/**
 * Classes for layer construction
 */
export class Layer {
    constructor(options) {
        this.name = '';
        this.id = '';
        this.opacity = 1;
        this.visible = true;
        this.removable = false;
        this.filtertype = 'Layers';
        this.continuousWorld = false;
        this.expanded = false;
        Object.assign(this, options);
    }
    get time() {
        return this.protTime;
    }
    set time(time) {
        this.protTime = time;
    }
}
export class RasterLayer extends Layer {
    constructor(options) {
        super(options);
        // if styles are given, set params and legendImg accordingly.
        if (this.styles && this.styles.length > 0) {
            let defaultStyle = this.styles.find(s => s.default);
            if (!defaultStyle) {
                defaultStyle = this.styles[0];
            }
            this.legendImg = defaultStyle.legendURL;
            if (this.params) {
                if (this.type === WmsLayertype) {
                    this.params.STYLES = defaultStyle.name;
                }
                else if (this.type === WmtsLayertype) {
                    this.params.style = defaultStyle.name;
                }
                this.params.STYLES = defaultStyle.name;
            }
            else if (this.type === WmtsLayertype) {
                if (!this.params) {
                    this.params = {};
                }
                this.params.style = defaultStyle.name;
            }
        }
    }
    set time(time) {
        if (this.params) {
            this.params.TIME = time;
        }
        this.protTime = time;
    }
    get time() {
        return this.protTime;
    }
}
/**
 * @deprecated The method should not be used because it can be false positive
 */
export const isRasterLayer = (layer) => {
    return isRasterLayertype(layer.type);
};
export class VectorLayer extends Layer {
    constructor(options) {
        super(options);
    }
}
/**
 * @deprecated The method should not be used because it can be false positive
 */
export const isVectorLayer = (layer) => {
    return isVectorLayertype(layer.type);
};
export class CustomLayer extends Layer {
    constructor(options) {
        super(options);
        this.type = CustomLayertype;
        // tslint:disable-next-line: variable-name
        this.custom_layer = {};
        Object.assign(this, options);
    }
}
export class StackedLayer extends Layer {
    constructor(options) {
        super(options);
        this.type = StackedLayertype;
        this.layers = [];
        Object.assign(this, options);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTGF5ZXJzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvc2VydmljZXMtbGF5ZXJzL3NyYy9saWIvdHlwZXMvTGF5ZXJzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQStEQSwrQkFBK0I7QUFDL0IsTUFBTSxDQUFDLE1BQU0sWUFBWSxHQUFHLEtBQUssQ0FBQztBQUNsQyxNQUFNLENBQUMsTUFBTSxZQUFZLEdBQUcsS0FBSyxDQUFDO0FBQ2xDLE1BQU0sQ0FBQyxNQUFNLGFBQWEsR0FBRyxNQUFNLENBQUM7QUFDcEMsTUFBTSxDQUFDLE1BQU0sWUFBWSxHQUFHLEtBQUssQ0FBQztBQUNsQyxNQUFNLENBQUMsTUFBTSxnQkFBZ0IsR0FBRyxTQUFTLENBQUM7QUFDMUMsTUFBTSxDQUFDLE1BQU0sWUFBWSxHQUFHLEtBQUssQ0FBQztBQUNsQyxNQUFNLENBQUMsTUFBTSxZQUFZLEdBQUcsS0FBSyxDQUFDO0FBQ2xDLCtCQUErQjtBQUMvQixNQUFNLENBQUMsTUFBTSxlQUFlLEdBQUcsUUFBUSxDQUFDO0FBQ3hDLGlEQUFpRDtBQUNqRCxNQUFNLENBQUMsTUFBTSxnQkFBZ0IsR0FBRyxTQUFTLENBQUM7QUFLMUMsTUFBTSxDQUFDLE1BQU0sV0FBVyxHQUFHO0lBQ3pCLFVBQVUsRUFBRSxZQUFZO0lBQ3hCLFFBQVEsRUFBRSxVQUFVO0lBQ3BCLE1BQU0sRUFBRSxRQUFRO0NBQ1IsQ0FBQztBQUlYOzs7OztHQUtHO0FBQ0gsTUFBTSxVQUFVLGlCQUFpQixDQUFDLElBQVk7SUFDNUMsT0FBTyxDQUFDLGdCQUFnQixFQUFFLFlBQVksRUFBRSxlQUFlLEVBQUUsWUFBWSxFQUFFLFlBQVksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUN0RyxDQUFDO0FBR0Q7Ozs7O0dBS0c7QUFDSCxNQUFNLFVBQVUsaUJBQWlCLENBQUMsSUFBWTtJQUM1QyxPQUFPLENBQUMsWUFBWSxFQUFFLGFBQWEsRUFB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RDs7R0FFRztBQUNILE1BQU0sQ0FBQyxNQUFNLGFBQWEsR0FBRyxDQUFDLEtBQVksRUFBd0IsRUFBRTtJQUNsRSxPQUFPLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUN2QyxDQUFDLENBQUM7QUFHRixNQUFNLE9BQU8sV0FBWSxTQUFRLEtBQUs7SUFZcEMsWUFBWSxPQUE0QjtRQUN0QyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDakIsQ0FBQztDQUNGO0FBRUQ7O0dBRUc7QUFDSCxNQUFNLENBQUMsTUFBTSxhQUFhLEdBQUcsQ0FBQyxLQUFZLEVBQXdCLEVBQUU7SUFDbEUsT0FBTyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDdkMsQ0FBQyxDQUFDO0FBRUYsTUFBTSxPQUFPLFdBQXFCLFNBQVEsS0FBSztJQUk3QyxZQUFZLE9BQStCO1FBQ3pDLEtBQUssQ0FBQyxPQUF3QixDQUFDLENBQUM7UUFKbEMsU0FBSSxHQUFHLGVBQWUsQ0FBQztRQUN2QiwwQ0FBMEM7UUFDMUMsaUJBQVksR0FBTSxFQUFPLENBQUM7UUFHeEIsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDL0IsQ0FBQztDQUNGO0FBRUQsTUFBTSxPQUFPLFlBQWEsU0FBUSxLQUFLO0lBR3JDLFlBQVksT0FBNkI7UUFDdkMsS0FBSyxDQUFDLE9BQXdCLENBQUMsQ0FBQztRQUhsQyxTQUFJLEdBQUcsZ0JBQWdCLENBQUM7UUFDeEIsV0FBTSxHQUFZLEVBQUUsQ0FBQztRQUduQixNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksRUFBRSxPQUFPLENBQUMsQ0FBQztJQUMvQixDQUFDO0NBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUeXBlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUFueU9iamVjdCB7XG4gIFtrOiBzdHJpbmddOiBhbnk7XG59XG5cbmludGVyZmFjZSBJRHluYW1pY0NvbXBvbmVudCB7XG4gIGNvbXBvbmVudDogVHlwZTxhbnk+O1xuICBpbnB1dHM/OiB7IFtpbnB1dDogc3RyaW5nXTogYW55IH07XG4gIG91dHB1dHM/OiB7IFtpbnB1dENoYW5nZTogc3RyaW5nXTogKHZhbHVlKSA9PiB2b2lkIH07XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUxheWVyQ29udGVudCBleHRlbmRzIElBbnlPYmplY3Qge1xuICAvKiogTUlNRSB0eXBlIG9mIHRoZSBDb250ZW50ICovXG4gIHR5cGU6IHN0cmluZztcbiAgaHJlZj86IHN0cmluZztcbiAgdGl0bGU/OiBzdHJpbmc7XG4gIC8qKiBTdHJpbmcgdHlwZSwgbm90IGVtcHR5IHRoYXQgY2FuIGNvbnRhaW4gYW55IHRleHQgZW5jb2RlZCBtZWRpYSB0eXBlICovXG4gIGNvbnRlbnQ/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUxheWVyU3R5bGVTZXQgZXh0ZW5kcyBJQW55T2JqZWN0IHtcbiAgbmFtZTogc3RyaW5nO1xuICB0aXRsZTogc3RyaW5nO1xuICBhYnN0cmFjdD86IHN0cmluZztcbiAgZGVmYXVsdD86IGJvb2xlYW47XG4gIGxlZ2VuZFVSTD86IHN0cmluZztcbiAgY29udGVudD86IElMYXllckNvbnRlbnQ7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgcG9wdXAge1xuICAvKiogbGltaXQgbGF5ZXIgb3IgZmVhdHVyZSBwcm9wZXJ0aWVzOiBvbmx5IHRob3NlIHByb3BlcnRpZXMgb2YgYSBsYXllci9mZWF0dXJlLCB0aGF0IGFyZSBsaXN0ZWQgaW4gdGhpcyBhcnJheSwgYXJlIGJlaW5nIHBhc3NlZCB0aHJvdWdoIHRvIGEgcG9wdXAtcmVuZGVyLWZ1bmN0aW9uICovXG4gIGZpbHRlcmtleXM/OiBBcnJheTxzdHJpbmc+O1xuICAvKiogVG8gb3ZlcndyaXRlIHRoZSBrZXlzIChhbmQgb25seSB0aGUga2V5cykgb2YgdGhlIGxheWVyL2ZlYXR1cmUgcHJvcGVydGllcy4gT2JqZWN0IGhhcyB0aGUgZm9ybSB7XCJvbGRLZXlcIjogXCJuZXdLZXlcIn0gKi9cbiAgcHJvcGVydGllcz86IElBbnlPYmplY3Q7XG4gIC8qKiBmdW5jdGlvbiB0byBjcmVhdGUgaHRtbCBzdHJpbmcgLSBwb3B1cG9iajogbmF0aXZlTGF5ZXIgKi9cbiAgcG9wdXBGdW5jdGlvbj86IChwb3B1cG9iajogSUFueU9iamVjdCkgPT4gc3RyaW5nO1xuICAvKiogYXN5bmMgZnVuY3Rpb24gd2hlcmUgeW91IGNhbiBwYXN0ZSBhIGh0bWwgc3RyaW5nIHRvIHRoZSBjYWxsYmFjayAtIHBvcHVwb2JqOiBuYXRpdmVMYXllciAqL1xuICBhc3luY1BvcHVwPzogKHBvcHVwb2JqOiBhbnksIGNiOiAoaHRtbDogYW55KSA9PiB2b2lkKSA9PiB2b2lkO1xuICAvKiogY3JlYXRlIHBvcHVwIHVzaW5nIGFuZ3VsYXIgY29tcG9uZW50ICovXG4gIGR5bmFtaWNQb3B1cD86IHtcbiAgICBjb21wb25lbnQ6IFR5cGU8YW55PjtcbiAgICBnZXRBdHRyaWJ1dGVzPzogKGFyZ3M6IGFueSkgPT4gb2JqZWN0O1xuICB9O1xuICAvKiogZGVmYXVsdCBldmVudCBpcyBjbGljayAtIHVzZSBtb3ZlIGZvciBhIHBvcHVwIG9uIGhvdmVyICovXG4gIGV2ZW50PzogJ21vdmUnIHwgJ2NsaWNrJztcbiAgLyoqIGRlZmF1bHQgaXMgZmFsc2UgLSByZW1vdmVzIHRoZSBvdGhlciBwb3B1cHMgaWYgdGhlIG5leHQgaXMgYWRkZWQgKi9cbiAgc2luZ2xlPzogYm9vbGVhbjtcbiAgLyoqIG9wdGlvbnMgd2hpY2ggZ2V0IGFzc2lnbmVkIG9uIHRoZSBwb3B1cCBjcmVhdGlvbnMgZS5nLiBvbC9PdmVybGF5ICovXG4gIG9wdGlvbnM/OiBJQW55T2JqZWN0O1xuICAvKiogSWYgdGhlIGxheWVyIHNob3VsZCBiZSBmaWx0ZXJlZCBvdXQgYW5kIHRoZSBwb3B1cCBiZW5lYXRoIHNob3VsZCBiZSBzaG93biBlLmcuIHRleHQgb3ZlcmxheXMgKi9cbiAgZmlsdGVyTGF5ZXI/OiBib29sZWFuO1xufVxuXG5cbi8qKlxuICogTGF5ZXIgZXZlbnRzIGxpa2UgcmVuZGVyaW5nIG9yIFNvdXJjZSBldmVudHMgbGlrZSBkYXRhIGxvYWQsIGNoYW5nZSwgZXJyb3IuLi5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBJTGF5ZXJFdmVudCB7XG4gIGV2ZW50OiBzdHJpbmc7XG4gIGxpc3RlbmVyOiAoYXJncz86IGFueSkgPT4gdm9pZDtcbn1cblxuLyoqIGNhbiBiZSByYXN0ZXIgYW5kIHZlY3RvciAqL1xuZXhwb3J0IGNvbnN0IFRtc0xheWVydHlwZSA9ICd0bXMnO1xuZXhwb3J0IGNvbnN0IFdtc0xheWVydHlwZSA9ICd3bXMnO1xuZXhwb3J0IGNvbnN0IFdtdHNMYXllcnR5cGUgPSAnd210cyc7XG5leHBvcnQgY29uc3QgWHl6TGF5ZXJ0eXBlID0gJ3h5eic7XG5leHBvcnQgY29uc3QgR2VvanNvbkxheWVydHlwZSA9ICdnZW9qc29uJztcbmV4cG9ydCBjb25zdCBLbWxMYXllcnR5cGUgPSAna21sJztcbmV4cG9ydCBjb25zdCBXZnNMYXllcnR5cGUgPSAnd2ZzJztcbi8qKiBjYW4gYmUgcmFzdGVyIGFuZCB2ZWN0b3IgKi9cbmV4cG9ydCBjb25zdCBDdXN0b21MYXllcnR5cGUgPSAnY3VzdG9tJztcbi8qKiBjYW4gaGF2ZSBtdWx0aXBsZSBsYXllcnMgcmFzdGVyLCB2ZWN0b3IuLi4gKi9cbmV4cG9ydCBjb25zdCBTdGFja2VkTGF5ZXJ0eXBlID0gJ3N0YWNrZWQnO1xuZXhwb3J0IHR5cGUgVFZlY3RvckxheWVydHlwZSA9IHR5cGVvZiBHZW9qc29uTGF5ZXJ0eXBlIHwgdHlwZW9mIFdmc0xheWVydHlwZSB8IHR5cGVvZiBUbXNMYXllcnR5cGUgfCB0eXBlb2YgS21sTGF5ZXJ0eXBlIHwgdHlwZW9mIEN1c3RvbUxheWVydHlwZTtcbmV4cG9ydCB0eXBlIFRSYXN0ZXJMYXllcnR5cGUgPSB0eXBlb2YgV21zTGF5ZXJ0eXBlIHwgdHlwZW9mIFdtdHNMYXllcnR5cGUgfCB0eXBlb2YgWHl6TGF5ZXJ0eXBlIHwgdHlwZW9mIFRtc0xheWVydHlwZSB8IHR5cGVvZiBDdXN0b21MYXllcnR5cGU7XG5leHBvcnQgdHlwZSBUTGF5ZXJ0eXBlID0gVFJhc3RlckxheWVydHlwZSB8IFRWZWN0b3JMYXllcnR5cGUgfCBzdHJpbmc7XG5cbmV4cG9ydCBjb25zdCBGaWx0ZXJ0eXBlcyA9IHtcbiAgQmFzZWxheWVyczogJ0Jhc2VsYXllcnMnLFxuICBPdmVybGF5czogJ092ZXJsYXlzJyxcbiAgTGF5ZXJzOiAnTGF5ZXJzJ1xufSBhcyBjb25zdDtcbmV4cG9ydCB0eXBlIFRGaWx0ZXJ0eXBlcyA9IGtleW9mIHR5cGVvZiBGaWx0ZXJ0eXBlcztcblxuXG4vKipcbiAqIEBkZXByZWNhdGVkIFRoZSBtZXRob2Qgc2hvdWxkIG5vdCBiZSB1c2VkIGJlY2F1c2UgaXQgY2FuIGJlIGZhbHNlIHBvc2l0aXZlXG4gKlxuICogQ3VzdG9tTGF5ZXJ0eXBlIGFuZCBUbXNMYXllcnR5cGUgY2FuIGJlIHJhc3RlciBhbmQgdmVjdG9yLlxuICogWW91IGhhdmUgdG8gZG91YmxlIGNoZWNrIGJ5IHlvdXJzZWxmIGxhdGVyIVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNWZWN0b3JMYXllcnR5cGUoaW5wdDogc3RyaW5nKTogaW5wdCBpcyBUVmVjdG9yTGF5ZXJ0eXBlIHtcbiAgcmV0dXJuIFtHZW9qc29uTGF5ZXJ0eXBlLCBXZnNMYXllcnR5cGUsIEN1c3RvbUxheWVydHlwZSwgS21sTGF5ZXJ0eXBlLCBUbXNMYXllcnR5cGVdLmluY2x1ZGVzKGlucHQpO1xufVxuXG5cbi8qKlxuICogQGRlcHJlY2F0ZWQgVGhlIG1ldGhvZCBzaG91bGQgbm90IGJlIHVzZWQgYmVjYXVzZSBpdCBjYW4gYmUgZmFsc2UgcG9zaXRpdmVcbiAqXG4gKiBDdXN0b21MYXllcnR5cGUgYW5kIFRtc0xheWVydHlwZSBjYW4gYmUgcmFzdGVyIGFuZCB2ZWN0b3IuXG4gKiBZb3UgaGF2ZSB0byBkb3VibGUgY2hlY2sgYnkgeW91cnNlbGYgbGF0ZXIhXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1Jhc3RlckxheWVydHlwZShpbnB0OiBzdHJpbmcpOiBpbnB0IGlzIFRSYXN0ZXJMYXllcnR5cGUge1xuICByZXR1cm4gW1dtc0xheWVydHlwZSwgV210c0xheWVydHlwZSwgWHl6TGF5ZXJ0eXBlLCBDdXN0b21MYXllcnR5cGUsIFRtc0xheWVydHlwZV0uaW5jbHVkZXMoaW5wdCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0xheWVydHlwZSh0eXBlOiBzdHJpbmcpOiB0eXBlIGlzIFRMYXllcnR5cGUge1xuICByZXR1cm4gW1Rtc0xheWVydHlwZSwgV21zTGF5ZXJ0eXBlLCBXbXRzTGF5ZXJ0eXBlLCBYeXpMYXllcnR5cGUsIEdlb2pzb25MYXllcnR5cGUsIEttbExheWVydHlwZSwgV2ZzTGF5ZXJ0eXBlLCBDdXN0b21MYXllcnR5cGVdLmluY2x1ZGVzKHR5cGUpO1xufVxuXG4vKipcbiAqIGdlb2dyYXBoaWMgY29vcmRpbmF0ZXNcbiAqIGxpa2Ugb2wuZXh0ZW50OiBtaW5YLCBtaW5ZLCBtYXhYLCBtYXhZXG4gKi9cbmV4cG9ydCB0eXBlIFRHZW9FeHRlbnQgPSBbbnVtYmVyLCBudW1iZXIsIG51bWJlciwgbnVtYmVyXSB8IFtudW1iZXIsIG51bWJlciwgbnVtYmVyLCBudW1iZXIsIG51bWJlciwgbnVtYmVyXTtcblxuLypcbiAqIFRoZXJlIGFyZSBlZmZlY3RpdmVseSBvbmx5IHR3byB2YWx1ZXMgdGhhdCB3ZSBtYXkgc2V0IGZvciBjb3JzOlxuICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSFRNTC9BdHRyaWJ1dGVzL2Nyb3Nzb3JpZ2luXG4gKi9cbmV4cG9ydCB0eXBlIENyb3NzT3JpZ2luVHlwZSA9ICdhbm9ueW1vdXMnIHwgJ3VzZS1jcmVkZW50aWFscyc7XG5cblxuZXhwb3J0IGludGVyZmFjZSBJTGF5ZXJPcHRpb25zIHtcbiAgbmFtZTogc3RyaW5nO1xuICBpZDogc3RyaW5nO1xuICAvLyBpZDogc3RyaW5nXG4gIHR5cGU6IFRMYXllcnR5cGU7XG5cbiAgZmlsdGVydHlwZT86IFRGaWx0ZXJ0eXBlcztcbiAgb3BhY2l0eT86IG51bWJlcjtcbiAgdmlzaWJsZT86IGJvb2xlYW47XG4gIHJlbW92YWJsZT86IGJvb2xlYW47XG4gIGNvbnRpbnVvdXNXb3JsZD86IGJvb2xlYW47XG4gIGF0dHJpYnV0aW9uPzogc3RyaW5nO1xuICBkaXNwbGF5TmFtZT86IHN0cmluZztcbiAgZGVzY3JpcHRpb24/OiBzdHJpbmc7XG4gIHRpbWU/OiBzdHJpbmc7XG4gIG1pblJlc29sdXRpb24/OiBudW1iZXI7XG4gIG1heFJlc29sdXRpb24/OiBudW1iZXI7XG4gIG1pblpvb20/OiBudW1iZXI7XG4gIG1heFpvb20/OiBudW1iZXI7XG4gIC8qKiBsZWdlbmQgZm9yIHRoZSBsYXllciBhcyBpbWFnZSBvciBhIGFuZ3VsYXIgY29tcG9uZW50ICovXG4gIGxlZ2VuZEltZz86IHN0cmluZyB8IElEeW5hbWljQ29tcG9uZW50O1xuICAvKiogZ2VvZ3JhcGhpYyBjb29yZGluYXRlcyAqL1xuICBiYm94PzogVEdlb0V4dGVudDtcbiAgZGltZW5zaW9ucz86IElMYXllckRpbWVuc2lvbnM7XG4gIC8qKiB0cnVlOiBzaG93IHBvcHVwIG9uIGNsaWNrIHwgYXJyYXk6IHNob3cgcG9wdXAgb24gY2xpY2sgYW5kIGxpbWl0IHByb3BlcnRpZXMgfCBvciB1c2UgYSBwb3B1cCBvYmplY3QgdG8gY29uZmlndXJlIHRoZSBwb3B1cFxuICAgKiBpZiBhIHBvcHVwIHNob3VsZCBiZSBzaG93biBvbiBtdWx0aXBsZSBldmVudHMgdXNlIGFuIGFycmF5IG9mIHBvcHVwIG9iamVjdCAob25seSB1bmlxdWUgZXZlbnRzKVxuICAgKi9cbiAgLy8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNTcwMTY3MjgvaXMtdGhlcmUtYS13YXktdG8tZGVmaW5lLXR5cGUtZm9yLWFycmF5LXdpdGgtdW5pcXVlLWl0ZW1zLWluLXR5cGVzY3JpcHRcbiAgcG9wdXA/OiBib29sZWFuIHwgQXJyYXk8c3RyaW5nPiB8IHBvcHVwIHwgcG9wdXBbXTtcbiAgZXZlbnRzPzoge1xuICAgIC8qKiBlLmcuIGh0dHBzOi8vb3BlbmxheWVycy5vcmcvZW4vdjYuNS4wL2FwaWRvYy9tb2R1bGUtb2xfbGF5ZXJfTGF5ZXItTGF5ZXIuaHRtbCBGaXJlcyAqL1xuICAgIGxheWVyPzogSUxheWVyRXZlbnRbXTtcbiAgICAvKiogZS5nLiBodHRwczovL29wZW5sYXllcnMub3JnL2VuL3Y2LjUuMC9hcGlkb2MvbW9kdWxlLW9sX3NvdXJjZV9Tb3VyY2UuaHRtbCBUaWxlIHwgSW1hZ2UgfCBSYXN0ZXIgfCBWZWN0b3IgKi9cbiAgICBzb3VyY2U/OiBJTGF5ZXJFdmVudFtdO1xuICB9O1xuICBhY3Rpb25zPzogW3sgdGl0bGU6IHN0cmluZywgaWNvbjogc3RyaW5nLCBhY3Rpb246IChMYXllcikgPT4gdm9pZCB9XTtcbiAgLyoqIG9wdGlvbmFsIGFuZ3VsYXIgY29tcG9uZW50IHRoYXQgY2FuIGJlIHVzZWQgZS5nLiB0byBjaGFuZ2UgdGhlIGxheWVyIHN0eWxlLCBmaWx0ZXIgdGhlIGRhdGEgb3IgcmVxdWVzdCBuZXcgZGF0YSAqL1xuICBhY3Rpb24/OiBJRHluYW1pY0NvbXBvbmVudDtcbiAgLyoqIGEgbGF5ZXIgbWlnaHQgaGF2ZSBtb3JlIHRoYW4gb25lIHN0eWxlOyBlZy4gdHJ1ZSBjb2xvciBhbmQgZmFsc2UgY29sb3IgZm9yIHRoZSBzYW1lIGRhdGFzZXQgKi9cbiAgc3R5bGVzPzogSUxheWVyU3R5bGVTZXRbXTtcbiAgLyoqIFRoZSBjcm9zc09yaWdpbiBhdHRyaWJ1dGUgZm9yIGxvYWRlZCBpbWFnZXMgaWYgeW91IHdhbnQgdG8gYWNjZXNzIHBpeGVsIGRhdGEgd2l0aCB0aGUgQ2FudmFzIHJlbmRlcmVyICovXG4gIGNyb3NzT3JpZ2luPzogQ3Jvc3NPcmlnaW5UeXBlO1xuICAvKiogVUkgaXMgZXhwYW5kZWQgKi9cbiAgZXhwYW5kZWQ/OiBib29sZWFuO1xuICAvKipcbiAgICogQ1NTIENsYXNzIGZvciBjdXN0b20gc3R5bGluZ1xuICAgKlxuICAgKiBJZiBjbGFzcyAnaGlkZScgaXMgaW5jbHVkZWQgaW4gdGhlIHN0cmluZywgdGhlIGxheWVyIGlzIG5vdCBzaG93biBpbiB0aGUgVUkgLSB0aGlzIGNhbiBwcm9iYWJseSBicmluZyBzaWRlIGVmZmVjdHMgd2hlbiBMYXllcnMgYXJlIHJlb3JkZXJlZCwgYmVjYXVzZSB0aGUgaGlkZGVuIGxheWVycyBjb3VsZCBiZSBtb3ZlZCBvbiB0b3Agb2ZmIGFsbCFcbiAgICovXG4gIGNzc0NsYXNzPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElMYXllckRpbWVuc2lvbnMgZXh0ZW5kcyBJQW55T2JqZWN0IHtcbiAgdGltZT86IElMYXllclRpbWVEaW1lbnNpb247XG4gIGVsZXZhdGlvbj86IElMYXllckVsZXZhdGlvbkRpbWVuc2lvbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJTGF5ZXJJbnRlcnZhbEFuZFBlcmlvZCB7XG4gIC8qKlxuICAgKiBFeGFtcGxlOiBcIjIwMTYtMDEtMDFUMDA6MDA6MDAuMDAwWi8yMDE4LTAxLTAxVDAwOjAwOjAwLjAwMFpcIlxuICAgKi9cbiAgaW50ZXJ2YWw6IHN0cmluZztcbiAgLyoqXG4gICAqIEV4YW1wbGU6IFwiUDFZXCJcbiAgICovXG4gIHBlcmlvZGljaXR5OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUxheWVyVGltZURpbWVuc2lvbiB7XG4gIHZhbHVlczogc3RyaW5nW10gfCBJTGF5ZXJJbnRlcnZhbEFuZFBlcmlvZFtdIHwgSUxheWVySW50ZXJ2YWxBbmRQZXJpb2Q7XG4gIHVuaXRzOiBzdHJpbmc7XG4gIGRpc3BsYXk/OiB7XG4gICAgZm9ybWF0Pzogc3RyaW5nO1xuICAgIHBlcmlvZD86IHN0cmluZztcbiAgICBkZWZhdWx0Pzogc3RyaW5nO1xuICB9O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElMYXllckVsZXZhdGlvbkRpbWVuc2lvbiB7XG4gIC8qKiBEZWZhdWx0IHN0ZXBzIHRvIGRpc3BsYXkgaW4gZWxldmF0aW9uIHNsaWRlciAqL1xuICB1bml0czogc3RyaW5nO1xuICB2YWx1ZXM6IHN0cmluZztcbiAgZGlzcGxheT86IHtcbiAgICBmb3JtYXQ/OiBzdHJpbmc7XG4gICAgc3RlcD86IHN0cmluZztcbiAgICBkZWZhdWx0Pzogc3RyaW5nO1xuICB9O1xufVxuXG5cbmV4cG9ydCBpbnRlcmZhY2UgSVJhc3RlckxheWVyT3B0aW9ucyBleHRlbmRzIElMYXllck9wdGlvbnMge1xuICB1cmw6IHN0cmluZztcbiAgc3ViZG9tYWlucz86IEFycmF5PHN0cmluZz47XG4gIC8qKiByYXN0ZXIgcGFyYW1zIGxpa2Ugd21zIHBhcmFtcyAtPiB0aW1lLCBsYXllcnMuLi4gZGVwZW5kcyBvbiB0aGUgbWFwLWxpYnJhcnkgKi9cbiAgcGFyYW1zPzogSVJhc3RlckxheWVyUGFyYW1zO1xuICAvKiogY2hlY2sgaWYgdGhlIHNlcnZpY2Ugc3VwcG9ydHMgdGhpcyB0aWxlc2l6ZSAqL1xuICB0aWxlU2l6ZT86IG51bWJlcjtcbiAgdHlwZTogVFJhc3RlckxheWVydHlwZTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJVmVjdG9yTGF5ZXJPcHRpb25zIGV4dGVuZHMgSUxheWVyT3B0aW9ucyB7XG4gIC8qKiBkYXRhOiBnZW9qc29uIGRhdGEgKi9cbiAgZGF0YT86IGFueTtcbiAgdXJsPzogc3RyaW5nO1xuICBzdWJkb21haW5zPzogQXJyYXk8c3RyaW5nPjtcbiAgLyoqIHZlY3RvciBvcHRpb25zIGxpa2Ugc3R5bGUsIHBvaW50VG9MYXllci4uLiBkZXBlbmRzIG9uIHRoZSBtYXAtbGlicmFyeSAqL1xuICBvcHRpb25zPzoge1xuICAgIC8qKiBvbC9zdHlsZS9TdHlsZSAqL1xuICAgIHN0eWxlOiBhbnk7XG4gICAgLyoqIHN0eWxlU291cmNlPU9wZW5NYXBTdHlsZS5zb3VyY2VLZXkgaWYgc3R5bGUgaXMgYSBPcGVuTWFwU3R5bGUgT2JqICovXG4gICAgc3R5bGVTb3VyY2U/OiBzdHJpbmc7XG4gICAgW2s6IHN0cmluZ106IGFueTtcbiAgfTtcbiAgLyoqIGlmIHRydWUgY2x1c3RlcnMgcG9pbnRzIHwgb3Igc2V0IGEgT2JqZWN0IHdpdGggY2x1c3RlciBvcHRpb25zIGUuZy4gZGlzdGFuY2UgLi4uIGRlcGVuZHMgb24gdGhlIG1hcC1saWJyYXJ5ICovXG4gIGNsdXN0ZXI/OiBib29sZWFuIHwgSUFueU9iamVjdDtcbiAgdHlwZTogVFZlY3RvckxheWVydHlwZTtcbn1cblxuLyoqXG4gKiBUaGUgYGNyb3NzT3JpZ2luYCBwcm9wZXJ0eSBjYW4gb3ZlcndyaXRlIHRoZSBvbmUgc2V0IGluIHRoZSBsYXllcnNvdXJjZSBvZiB0aGUgY3VzdG9tX2xheWVyIGlmIHRoZXJlIGlzIHN1Y2ggYSBwcm9wZXJ0eSBlLmcuIHdoZW4gdXNpbmcgT3BlbkxheWVycyBhcyBhIG1hcC1lbmdpbmVcbiAqIEl0IGFsc28gY2FuIGJlIHVzZWQgdG8gZGlzYWJsZSBnZXQgY29sb3IgdmFsdWVzIGZvciBhIE9wZW5MYXllcnMgbGF5ZXIgaW4gdGhlIGxheWVyIHBvcHVwIHdoZW4gc2V0IHRvIGNyb3NzT3JpZ2luOiBudWxsXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSUN1c3RvbUxheWVyT3B0aW9uczxUID0gYW55PiBleHRlbmRzIE9taXQ8SUxheWVyT3B0aW9ucywgJ3R5cGUnPiB7XG4gIHR5cGU/OiBUTGF5ZXJ0eXBlO1xuICBjdXN0b21fbGF5ZXI6IFQ7XG59XG5cbi8qKlxuICogTGF5ZXJzIGlzIGFuIGFycmF5IG9mIGxheWVycyB3aGljaCBnZXQgc3RhY2tlZCB0b2dldGhlciBhbmQgc2hvd24gYXMgb25lIGxheWVyXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSVN0YWNrZWRMYXllck9wdGlvbnMgZXh0ZW5kcyBPbWl0PElMYXllck9wdGlvbnMsICd0eXBlJz4ge1xuICB0eXBlPzogVExheWVydHlwZTtcbiAgbGF5ZXJzOiBMYXllcltdO1xufVxuXG5cbi8qKlxuICogQ2xhc3NlcyBmb3IgbGF5ZXIgY29uc3RydWN0aW9uXG4gKi9cbmV4cG9ydCBjbGFzcyBMYXllciBpbXBsZW1lbnRzIElMYXllck9wdGlvbnMge1xuICBuYW1lID0gJyc7XG4gIGlkID0gJyc7XG4gIHR5cGU6IFRMYXllcnR5cGU7XG4gIG9wYWNpdHkgPSAxO1xuICB2aXNpYmxlID0gdHJ1ZTtcbiAgcmVtb3ZhYmxlID0gZmFsc2U7XG5cbiAgZmlsdGVydHlwZT86IFRGaWx0ZXJ0eXBlcyA9ICdMYXllcnMnO1xuICBjb250aW51b3VzV29ybGQgPSBmYWxzZTtcbiAgYXR0cmlidXRpb24/OiBzdHJpbmc7XG4gIGRpc3BsYXlOYW1lPzogc3RyaW5nO1xuICBkZXNjcmlwdGlvbj86IHN0cmluZztcbiAgcHJvdGVjdGVkIHByb3RUaW1lPzogc3RyaW5nO1xuICBtaW5SZXNvbHV0aW9uPzogbnVtYmVyO1xuICBtYXhSZXNvbHV0aW9uPzogbnVtYmVyO1xuICBtaW5ab29tPzogbnVtYmVyO1xuICBtYXhab29tPzogbnVtYmVyO1xuICBsZWdlbmRJbWc/OiBzdHJpbmcgfCBJRHluYW1pY0NvbXBvbmVudDtcblxuICBiYm94PzogVEdlb0V4dGVudDtcbiAgZGltZW5zaW9ucz86IElMYXllckRpbWVuc2lvbnM7XG5cbiAgcG9wdXA/OiBJTGF5ZXJPcHRpb25zWydwb3B1cCddO1xuICBldmVudHM/OiBJTGF5ZXJPcHRpb25zWydldmVudHMnXTtcbiAgYWN0aW9ucz86IFt7IHRpdGxlOiBzdHJpbmcsIGljb246IHN0cmluZywgYWN0aW9uOiAoTGF5ZXIpID0+IHZvaWQgfV07XG5cbiAgYWN0aW9uPzogSUR5bmFtaWNDb21wb25lbnQ7XG5cbiAgc3R5bGVzPzogSUxheWVyU3R5bGVTZXRbXTtcbiAgY3Jvc3NPcmlnaW4/OiBDcm9zc09yaWdpblR5cGU7XG4gIGV4cGFuZGVkID0gZmFsc2U7XG4gIGNzc0NsYXNzPzogc3RyaW5nO1xuXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IElMYXllck9wdGlvbnMpIHtcbiAgICBPYmplY3QuYXNzaWduKHRoaXMsIG9wdGlvbnMpO1xuICB9XG5cbiAgZ2V0IHRpbWUoKSB7XG4gICAgcmV0dXJuIHRoaXMucHJvdFRpbWU7XG4gIH1cbiAgc2V0IHRpbWUodGltZTogc3RyaW5nKSB7XG4gICAgdGhpcy5wcm90VGltZSA9IHRpbWU7XG4gIH1cbn1cbi8qKiByYXN0ZXIgcGFyYW1zIGxpa2Ugd21zIHBhcmFtcyAtPiB0aW1lLCBsYXllcnMuLi4gZGVwZW5kcyBvbiB0aGUgbWFwLWxpYnJhcnkgKi9cbmV4cG9ydCBpbnRlcmZhY2UgSVJhc3RlckxheWVyUGFyYW1zIGV4dGVuZHMgSUFueU9iamVjdCB7XG4gIExBWUVSUz86IHN0cmluZztcbiAgRk9STUFUPzogc3RyaW5nO1xuICBUSU1FPzogc3RyaW5nO1xuICBWRVJTSU9OPzogc3RyaW5nO1xuICBUSUxFRD86IHN0cmluZztcbiAgVFJBTlNQQVJFTlQ/OiBib29sZWFuO1xuICBTVFlMRVM/OiBzdHJpbmc7XG4gIC8qKiBodHRwczovL2RvY3MuZ2Vvc2VydmVyLm9yZy9sYXRlc3QvZW4vdXNlci90dXRvcmlhbHMvY3FsL2NxbF90dXRvcmlhbC5odG1sI2NxbC10dXRvcmlhbCAqL1xuICBDUUxfRklMVEVSPzogc3RyaW5nO1xuICAvKiogaHR0cHM6Ly9kb2NzLmdlb3NlcnZlci5vcmcvbGF0ZXN0L2VuL3VzZXIvc3R5bGluZy9zbGQvcmVmZXJlbmNlL2ZpbHRlcnMuaHRtbCAqL1xuICBGSUxURVI/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBSYXN0ZXJMYXllciBleHRlbmRzIExheWVyIGltcGxlbWVudHMgSVJhc3RlckxheWVyT3B0aW9ucyB7XG4gIHR5cGU6IFRSYXN0ZXJMYXllcnR5cGU7XG4gIHVybDogc3RyaW5nO1xuICBzdWJkb21haW5zPzogQXJyYXk8c3RyaW5nPjtcbiAgcGFyYW1zPzogSVJhc3RlckxheWVyUGFyYW1zO1xuICAvKiogY2hlY2sgaWYgdGhlIHNlcnZpY2Ugc3VwcG9ydHMgdGhpcyB0aWxlc2l6ZSAqL1xuICB0aWxlU2l6ZT86IG51bWJlcjtcblxuICBjb25zdHJ1Y3RvcihvcHRpb25zOiBJUmFzdGVyTGF5ZXJPcHRpb25zKSB7XG4gICAgc3VwZXIob3B0aW9ucyk7XG5cbiAgICAvLyBpZiBzdHlsZXMgYXJlIGdpdmVuLCBzZXQgcGFyYW1zIGFuZCBsZWdlbmRJbWcgYWNjb3JkaW5nbHkuXG4gICAgaWYgKHRoaXMuc3R5bGVzICYmIHRoaXMuc3R5bGVzLmxlbmd0aCA+IDApIHtcbiAgICAgIGxldCBkZWZhdWx0U3R5bGUgPSB0aGlzLnN0eWxlcy5maW5kKHMgPT4gcy5kZWZhdWx0KTtcblxuICAgICAgaWYgKCFkZWZhdWx0U3R5bGUpIHtcbiAgICAgICAgZGVmYXVsdFN0eWxlID0gdGhpcy5zdHlsZXNbMF07XG4gICAgICB9XG5cbiAgICAgIHRoaXMubGVnZW5kSW1nID0gZGVmYXVsdFN0eWxlLmxlZ2VuZFVSTDtcbiAgICAgIGlmICh0aGlzLnBhcmFtcykge1xuICAgICAgICBpZiAodGhpcy50eXBlID09PSBXbXNMYXllcnR5cGUpIHtcbiAgICAgICAgICB0aGlzLnBhcmFtcy5TVFlMRVMgPSBkZWZhdWx0U3R5bGUubmFtZTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnR5cGUgPT09IFdtdHNMYXllcnR5cGUpIHtcbiAgICAgICAgICB0aGlzLnBhcmFtcy5zdHlsZSA9IGRlZmF1bHRTdHlsZS5uYW1lO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucGFyYW1zLlNUWUxFUyA9IGRlZmF1bHRTdHlsZS5uYW1lO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLnR5cGUgPT09IFdtdHNMYXllcnR5cGUpIHtcbiAgICAgICAgaWYgKCF0aGlzLnBhcmFtcykge1xuICAgICAgICAgIHRoaXMucGFyYW1zID0ge307XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wYXJhbXMuc3R5bGUgPSBkZWZhdWx0U3R5bGUubmFtZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBzZXQgdGltZSh0aW1lOiBzdHJpbmcpIHtcbiAgICBpZiAodGhpcy5wYXJhbXMpIHtcbiAgICAgIHRoaXMucGFyYW1zLlRJTUUgPSB0aW1lO1xuICAgIH1cbiAgICB0aGlzLnByb3RUaW1lID0gdGltZTtcbiAgfVxuXG4gIGdldCB0aW1lKCkge1xuICAgIHJldHVybiB0aGlzLnByb3RUaW1lO1xuICB9XG59XG5cbi8qKlxuICogQGRlcHJlY2F0ZWQgVGhlIG1ldGhvZCBzaG91bGQgbm90IGJlIHVzZWQgYmVjYXVzZSBpdCBjYW4gYmUgZmFsc2UgcG9zaXRpdmVcbiAqL1xuZXhwb3J0IGNvbnN0IGlzUmFzdGVyTGF5ZXIgPSAobGF5ZXI6IExheWVyKTogbGF5ZXIgaXMgUmFzdGVyTGF5ZXIgPT4ge1xuICByZXR1cm4gaXNSYXN0ZXJMYXllcnR5cGUobGF5ZXIudHlwZSk7XG59O1xuXG5cbmV4cG9ydCBjbGFzcyBWZWN0b3JMYXllciBleHRlbmRzIExheWVyIGltcGxlbWVudHMgSVZlY3RvckxheWVyT3B0aW9ucyB7XG4gIHR5cGU6IFRWZWN0b3JMYXllcnR5cGU7XG4gIC8qKiBkYXRhOiBnZW9qc29uIGRhdGEgKi9cbiAgZGF0YT86IGFueTtcbiAgdXJsPzogc3RyaW5nO1xuICBzdWJkb21haW5zPzogQXJyYXk8c3RyaW5nPjtcbiAgLyoqIHZlY3RvciBvcHRpb25zIGxpa2Ugc3R5bGUsIHBvaW50VG9MYXllci4uLiBkZXBlbmQgb24gdGhlIG1hcC1saWJyYXJ5LCBlLmcuOlxuICAgKiBpY29uVXJsOiBzdHJpbmcgLSB0byBzcGVjaWZ5IGljb24gZm9yIHBvaW50c1xuICAgKiByb3RhdGlvblByb3BOYW1lOiBzdHJpbmcgLSBwcm9wZXJ0eSBjb250YWluaW5nIHJvdGF0aW9uIGFuZ2xlIGluIGRlZ3JlZXNcbiAgICovXG4gIG9wdGlvbnM/OiBJVmVjdG9yTGF5ZXJPcHRpb25zWydvcHRpb25zJ107XG4gIGNsdXN0ZXI/OiBJVmVjdG9yTGF5ZXJPcHRpb25zWydjbHVzdGVyJ107XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IElWZWN0b3JMYXllck9wdGlvbnMpIHtcbiAgICBzdXBlcihvcHRpb25zKTtcbiAgfVxufVxuXG4vKipcbiAqIEBkZXByZWNhdGVkIFRoZSBtZXRob2Qgc2hvdWxkIG5vdCBiZSB1c2VkIGJlY2F1c2UgaXQgY2FuIGJlIGZhbHNlIHBvc2l0aXZlXG4gKi9cbmV4cG9ydCBjb25zdCBpc1ZlY3RvckxheWVyID0gKGxheWVyOiBMYXllcik6IGxheWVyIGlzIFZlY3RvckxheWVyID0+IHtcbiAgcmV0dXJuIGlzVmVjdG9yTGF5ZXJ0eXBlKGxheWVyLnR5cGUpO1xufTtcblxuZXhwb3J0IGNsYXNzIEN1c3RvbUxheWVyPFQgPSBhbnk+IGV4dGVuZHMgTGF5ZXIgaW1wbGVtZW50cyBJQ3VzdG9tTGF5ZXJPcHRpb25zPFQ+IHtcbiAgdHlwZSA9IEN1c3RvbUxheWVydHlwZTtcbiAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOiB2YXJpYWJsZS1uYW1lXG4gIGN1c3RvbV9sYXllcjogVCA9IHt9IGFzIFQ7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IElDdXN0b21MYXllck9wdGlvbnM8VD4pIHtcbiAgICBzdXBlcihvcHRpb25zIGFzIElMYXllck9wdGlvbnMpO1xuICAgIE9iamVjdC5hc3NpZ24odGhpcywgb3B0aW9ucyk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFN0YWNrZWRMYXllciBleHRlbmRzIExheWVyIGltcGxlbWVudHMgSVN0YWNrZWRMYXllck9wdGlvbnMge1xuICB0eXBlID0gU3RhY2tlZExheWVydHlwZTtcbiAgbGF5ZXJzOiBMYXllcltdID0gW107XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IElTdGFja2VkTGF5ZXJPcHRpb25zKSB7XG4gICAgc3VwZXIob3B0aW9ucyBhcyBJTGF5ZXJPcHRpb25zKTtcbiAgICBPYmplY3QuYXNzaWduKHRoaXMsIG9wdGlvbnMpO1xuICB9XG59XG4iXX0=