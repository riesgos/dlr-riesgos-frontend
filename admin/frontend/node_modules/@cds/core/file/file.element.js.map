{"version":3,"file":"file.element.js","sources":["../../../src/file/file.element.ts"],"sourcesContent":["/*\n * Copyright (c) 2016-2022 VMware, Inc. All Rights Reserved.\n * This software is released under MIT license.\n * The full license information can be found in LICENSE in the root directory of this project.\n */\nimport { __decorate } from \"tslib\";\nimport { html } from 'lit';\nimport { state, i18n, I18nService } from '@cds/core/internal';\nimport { CdsControl } from '@cds/core/forms';\nimport styles from './file.element.scss';\n/**\n * Time Input\n *\n * ```typescript\n * import '@cds/core/file/register.js';\n * ```\n *\n * ```html\n * <cds-file>\n *   <label>file</label>\n *   <input type=\"file\" />\n * </cds-file>\n * ```\n *\n * @element cds-file\n * @slot - For projecting file input and label\n */\nexport class CdsFile extends CdsControl {\n    constructor() {\n        super(...arguments);\n        this.i18n = I18nService.keys.file;\n        this.buttonLabel = this.i18n.browse;\n        this.fixedControlWidth = true;\n        this.supportsPrefixSuffixActions = false;\n    }\n    static get styles() {\n        return [...super.styles, styles];\n    }\n    get inputTemplate() {\n        return html `\n      <div cds-layout=\"horizontal gap:sm align:vertical-center\">\n        <cds-button size=\"sm\" action=\"outline\" @click=\"${() => this.label.click()}\" ?disabled=${this.disabled}>\n          <cds-icon shape=\"folder\" aria-hidden=\"true\"></cds-icon>\n          <span>${this.buttonLabel}</span>\n        </cds-button>\n        ${this.clearFilesControlTemplate}\n      </div>\n    `;\n    }\n    get clearFilesControlTemplate() {\n        return this.inputControl.files?.length && !this.disabled\n            ? html `<cds-button-action\n          shape=\"times\"\n          @click=${() => this.clearFiles()}\n          aria-label=\"${this.i18n.removeFile}\"\n        ></cds-button-action>`\n            : html ``;\n    }\n    firstUpdated(props) {\n        super.firstUpdated(props);\n        this.inputControl.addEventListener('change', e => {\n            // NOTE: have to distinguish here being user-caused events and programmatic\n            // events (e.isTrusted true/false) so that we don't fire a change event loop\n            if (e.isTrusted) {\n                this.updateLabelAndFocus(e.target.files);\n            }\n        });\n    }\n    /** @private */\n    clearFiles(fireEvent = true) {\n        this.buttonLabel = this.i18n.browse;\n        this.inputControl.value = '';\n        // when input is reset like this it isn't registering an onchange event\n        // NOTE: tsc + karma is complaining about dispatchEvent being a method on inputControl\n        if (fireEvent && this.inputControl.dispatchEvent) {\n            this.inputControl.dispatchEvent(new Event('change'));\n        }\n        const browseButton = this.shadowRoot?.querySelector('cds-button');\n        if (browseButton) {\n            browseButton.focus();\n        }\n    }\n    /** @private */\n    updateLabelAndFocus(files) {\n        if (files && files.length) {\n            this.buttonLabel = files.length > 1 ? `${files.length} ${this.i18n.files}` : files[0].name;\n        }\n        else {\n            this.clearFiles(false);\n        }\n    }\n}\n__decorate([\n    i18n()\n], CdsFile.prototype, \"i18n\", void 0);\n__decorate([\n    state()\n], CdsFile.prototype, \"buttonLabel\", void 0);\n__decorate([\n    state()\n], CdsFile.prototype, \"fixedControlWidth\", void 0);\n__decorate([\n    state()\n], CdsFile.prototype, \"supportsPrefixSuffixActions\", void 0);\n"],"names":["CdsFile","CdsControl","constructor","super","this","i18n","I18nService","keys","file","buttonLabel","browse","fixedControlWidth","supportsPrefixSuffixActions","styles","inputTemplate","html","label","click","disabled","clearFilesControlTemplate","inputControl","files","length","clearFiles","removeFile","firstUpdated","props","addEventListener","e","isTrusted","updateLabelAndFocus","target","fireEvent","value","dispatchEvent","Event","browseButton","shadowRoot","querySelector","focus","name","__decorate","prototype","state"],"mappings":"uNA2BO,MAAMA,UAAgBC,EACzBC,cACIC,oBACAC,KAAKC,KAAOC,EAAYC,KAAKC,KAC7BJ,KAAKK,YAAcL,KAAKC,KAAKK,OAC7BN,KAAKO,mBAAoB,EACzBP,KAAKQ,6BAA8B,EAE5BC,oBACP,MAAO,IAAIV,MAAMU,OAAQA,GAEzBC,oBACA,OAAOC,CAAK,4GAEqC,IAAMX,KAAKY,MAAMC,uBAAsBb,KAAKc,0EAEnFd,KAAKK,kCAEbL,KAAKe,kCAIPA,gCACA,OAAOf,KAAKgB,aAAaC,OAAOC,SAAWlB,KAAKc,SAC1CH,CAAK,4CAEA,IAAMX,KAAKmB,6BACNnB,KAAKC,KAAKmB,mCAEpBT,CAAK,GAEfU,aAAaC,GACTvB,MAAMsB,aAAaC,GACnBtB,KAAKgB,aAAaO,iBAAiB,UAAUC,IAGrCA,EAAEC,WACFzB,KAAK0B,oBAAoBF,EAAEG,OAAOV,UAK9CE,WAAWS,GAAY,GACnB5B,KAAKK,YAAcL,KAAKC,KAAKK,OAC7BN,KAAKgB,aAAaa,MAAQ,GAGtBD,GAAa5B,KAAKgB,aAAac,eAC/B9B,KAAKgB,aAAac,cAAc,IAAIC,MAAM,WAE9C,MAAMC,EAAehC,KAAKiC,YAAYC,cAAc,cAChDF,GACAA,EAAaG,QAIrBT,oBAAoBT,GACZA,GAASA,EAAMC,OACflB,KAAKK,YAAcY,EAAMC,OAAS,EAAI,GAAGD,EAAMC,UAAUlB,KAAKC,KAAKgB,QAAUA,EAAM,GAAGmB,KAGtFpC,KAAKmB,YAAW,IAI5BkB,EAAW,CACPpC,KACDL,EAAQ0C,UAAW,YAAQ,GAC9BD,EAAW,CACPE,KACD3C,EAAQ0C,UAAW,mBAAe,GACrCD,EAAW,CACPE,KACD3C,EAAQ0C,UAAW,yBAAqB,GAC3CD,EAAW,CACPE,KACD3C,EAAQ0C,UAAW,mCAA+B"}